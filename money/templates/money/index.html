{% extends 'money/base.html' %}

{% block content %}
<div class="container">
<h1 class="py-4">Dashboard</h1>
    <div class="row">
        <div class="col-md-4">
            <div class="card text-center text-danger">
                <div class="card-body">
                    <p class="card-text">
                        <h1>Rs. {{ expenses }} </h1>
                    </p>
                </div>
                <div class="card-footer text-white bg-danger">
                    <span class="fas fa-money-bill-wave fa-2x"></span> 
                    <span class="ml-4"> Expenses  </span>
                </div>
            </div>
        </div>
        <div class="col-md-4">
            <div class="card text-center text-success">
                <div class="card-body">
                    <p class="card-text">
                        <h1>Rs.  {{ incomes }}</h1>
                    </p>
                </div>
                <div class="card-footer text-white bg-success">
                    <span class="fas fa-money-bill-wave fa-2x"></span> 
                    <span class="ml-4"> Income  </span>
                </div>
            </div>
        
        </div>
        <div class="col-md-4">
            <div class="card text-center">
                <div class="card-body text-warning">
                    <p class="card-text">
                        <h1>Rs.  {{ remaining }}</h1>
                    </p>
                </div>
                <div class="card-footer text-white bg-warning">
                    <span class="fas fa-money-bill-wave fa-2x"></span> 
                    <span class="ml-4"> Cash in Hand  </span>
                </div>
            </div>
        
        </div>
    </div>

    <div id="container">
        <div class="row">
            <div class="col-md-6">
                <canvas id="transactionChart" data-url="{% url 'pieChart' %}"></canvas>
            </div>
            <div class="col-md-6">
                <canvas id="income_expense_chart" data-url="{% url 'income_expense_chart' %}"></canvas>
            </div>
        </div>
    </div>

    <script src="https://code.jquery.com/jquery-3.4.1.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/chart.js@2.9.3/dist/Chart.min.js"></script>

    <script>
        $(function (){
            var $transactionChart = $("#transactionChart");
            var $income_expense_chart = $("income_expense_chart")
            



        $.ajax({
                url:$income_expense_chart.data("url"),
                success: function (data) {
                    console.log(data)
                    var ctx = $income_expense_chart[0].getContext("2d");

                    var pieChart = new Chart(ctx, {
                        type: 'pie',
                        data: {
                datasets: [{
                        data: data.data,
                        backgroundColor: [
                            '#69789', '#fa8080', '#A9A9b6', '#99C0C0', '#D3D983'
                        ],
                        label: 'Transactions'
                    }],
                    labels: data.labels
                },
                options: {
                responsive: true
                },
                })

                }
            })
        });
    </script>
</div>
{% endblock content %}
